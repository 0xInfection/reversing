<h1>Part 19 – Hacking ADDS</h1><p>For a complete table of contents of all the lessons please click below as it will give you a brief of each lesson in addition to the topics it will cover. https://github.com/mytechnotalent/Reverse-Engineering-Tutorial</p><p>Let’s once again re-examine our code:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQH7FHMg_SnYPQ/article-inline_image-shrink_1000_1488/0/1520215587042?e=1614211200&amp;v=beta&amp;t=v0X2IQbwG2X-wO-7_kePgRwn1PX0DeocwPk7mzNZlgk"/></div><p>We again <strong>add</strong> <strong>100</strong> decimal into <strong>r1</strong>, <strong>4,294,967,295</strong> into <strong>r2</strong>. We then <strong>add r1</strong> and <strong>r2</strong> and place in <strong>r0.</strong></p><p>Lets debug:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHGLXJvyy9xww/article-inline_image-shrink_1000_1488/0/1520594576879?e=1614211200&amp;v=beta&amp;t=vbj9DCK4M2W14M8m6MbEE8h2OyKVcilAoGvncNIEQYA"/></div><p>We again see <strong>adds </strong>which sets the flags in the CPSR. We have to remember when we debug in GDB, the value of the CPSR is in hex. In order to see what flags are set, we must convert the hex to binary. This will make sense as we start to debug and hack this example in the coming tutorials.</p><p>We need to remember that bits 31, 20, 29 and 28 in the CPSR indicate the following:</p><p><strong>bit 31 - N = Negative Flag</strong></p><p><strong>bit 30 - Z = Zero Flag</strong></p><p><strong>bit 29 - C = Carry Flag</strong></p><p><strong>bit 28 - V = Overflow Flag</strong></p><p>We see the <strong>CPSR</strong> at <strong>10 hex</strong>. <strong>10 hex</strong> in binary is <strong>0001</strong>.</p><p>Therefore if the value in binary was <strong>0001</strong> of bit 31, 30, 29 and 28 (<strong>NZCV</strong>) that would mean:</p><p><strong>Negative Flag NOT Set</strong></p><p><strong>Zero Flag NOT SET</strong></p><p><strong>Carry Flag NOT SET</strong></p><p><strong>Overflow Flag Set </strong></p><p>Lets take a look if we step again:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFVriYdIiJwxg/article-inline_image-shrink_1000_1488/0/1520149286284?e=1614211200&amp;v=beta&amp;t=MN5nZYgUbpPpc_eOiSLHirlRPl3g-2g77Cv3yUqlDOg"/></div><p>We see <strong>4294967295 decimal</strong> or <strong>0xffffffff </strong>in <strong>r2</strong>. We know if we step again we will cause the CPSR to change from 0001 to 0010 which means:</p><p>The value in binary is <strong>0010</strong> of bit 31, 30, 29 and 28 (<strong>NZCV</strong>) that would mean:</p><p><strong>Negative Flag NOT Set</strong></p><p><strong>Zero Flag NOT SET</strong></p><p><strong>Carry Flag SET</strong></p><p><strong>Overflow Flag NOT Set</strong></p><p>This action sets the carry flag. However lets hack:</p><div class="slate-resizable-image-embed slate-image-embed__resize-middle"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQE3luUGwcgEbw/article-inline_image-shrink_1000_1488/0/1520147275008?e=1614211200&amp;v=beta&amp;t=4aI4HJ-k25hpkDTyO4_3fXvcY5RUbazE3bj-KllyF8k"/></div><p>We hacked <strong>r2</strong> and changed the value to <strong>1 decimal </strong>and<strong> 0x1 hex</strong>. NOW we know before the<strong> CPSR </strong>went to <strong>0010</strong> last time however now that we hacked this, lets see what happens to the <strong>CPSR</strong> when we step.</p><div class="slate-resizable-image-embed slate-image-embed__resize-middle"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFXZWdPV19yMA/article-inline_image-shrink_1000_1488/0/1520211562604?e=1614211200&amp;v=beta&amp;t=EAxw6SGUC-b_7_IkDCoL4i3rRmRM_X2cjnOyFaWpP9E"/></div><p>BAM! We hacked it and see<strong> r0 </strong>is <strong>101</strong> and therefore did NOT trigger the carry flag and kept the <strong>CPSR</strong> at<strong> 0x10 hex </strong>which means <strong>0001 binary </strong>which means:</p><p>Therefore if the value in binary was <strong>0001</strong> of bit 31, 30, 29 and 28 (<strong>NZCV</strong>) that would mean:</p><p><strong>Negative Flag NOT Set</strong></p><p><strong>Zero Flag NOT SET</strong></p><p><strong>Carry Flag NOT SET</strong></p><p><strong>Overflow Flag Set </strong></p><p>It is so important that you understand this lesson in its entirety. If not, please review the last two weeks lessons.</p><p>Next week we will dive into ADC.</p><p><br/></p>