<h1>Part 18 – Debugging ADDS</h1><p>For a complete table of contents of all the lessons please click below as it will give you a brief of each lesson in addition to the topics it will cover. https://github.com/mytechnotalent/Reverse-Engineering-Tutorial</p><p>Let’s re-examine our code:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEp6bZuV-CIqA/article-inline_image-shrink_1000_1488/0/1520230639459?e=1614211200&amp;v=beta&amp;t=p-e2wCJx6Dp9IIHZUABhcXu3tYY1RVUUN0SN9HgG33M"/></div><p>We again <strong>add</strong> <strong>100</strong> decimal into <strong>r1</strong>, <strong>4,294,967,295</strong> into <strong>r2</strong>. We then <strong>add r1</strong> and <strong>r2</strong> and place in <strong>r0.</strong></p><p>Lets debug:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHhMjLWYNsk-A/article-inline_image-shrink_1000_1488/0/1520149414710?e=1614211200&amp;v=beta&amp;t=JGkOkDQ5VJ5hkmKcJ9gYbAlh_MV-MiH4cMqqGBoRLzg"/></div><p>We again see <strong>adds </strong>which sets the flags in the CPSR. We have to remember when we debug in GDB, the value of the CPSR is in hex. In order to see what flags are set, we must convert the hex to binary. This will make sense as we start to debug and hack this example in the coming tutorials.</p><p>We need to remember that bits 31, 20, 29 and 28 in the CPSR indicate the following:</p><p><strong>bit 31 - N = Negative Flag</strong></p><p><strong>bit 30 - Z = Zero Flag</strong></p><p><strong>bit 29 - C = Carry Flag</strong></p><p><strong>bit 28 - V = Overflow Flag</strong></p><p>We see the <strong>CPSR</strong> at <strong>10 hex</strong>. <strong>10 hex</strong> in binary is <strong>0001</strong>.</p><p>Therefore if the value in binary was <strong>0001</strong> of bit 31, 30, 29 and 28 (<strong>NZCV</strong>) that would mean:</p><p><strong>Negative Flag NOT Set</strong></p><p><strong>Zero Flag NOT SET</strong></p><p><strong>Carry Flag NOT SET</strong></p><p><strong>Overflow Flag Set </strong></p><p>There is nothing in code above which set the <strong>Overflow Flag</strong> however in it’s natural state upon executing this binary it is set.</p><p>Lets step through the program:</p><div class="slate-resizable-image-embed slate-image-embed__resize-middle"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHOCMLh0ihJfQ/article-inline_image-shrink_1000_1488/0/1520609481159?e=1614211200&amp;v=beta&amp;t=mgPAVlG2EYL2CPnWAKfDLzdT-WDXzPUDPdjWQIgLu5c"/></div><p>We see <strong>64 hex</strong> or <strong>100 decimal </strong>moved into <strong>r1</strong> as expected. No change in the <strong>CPSR</strong>. Lets step some more.</p><div class="slate-resizable-image-embed slate-image-embed__resize-middle"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQG_Qy-xMKNKTQ/article-inline_image-shrink_1000_1488/0/1520042941149?e=1614211200&amp;v=beta&amp;t=YDzRxFgnE36cG7ViruMt4qSzUDbBJrVc8g6o4NUhCPg"/></div><p>We see the addition that transpires above and notice the value in <strong>r0 </strong>is <strong>99 decimal</strong> after <strong>100 decimal</strong> and <strong>4294967295 decimal</strong> were added together. How is that possible? The answer is simple, we overflowed the 32-bit register of <strong>r0</strong> from this addition.</p><p>If we examine the <strong>CPSR</strong> we now see <strong>20000010 hex</strong> or <strong>0010 0000 0000 0000 0000 0000 0001 0000 binary</strong>. We only have to focus on the most significant bits which are <strong>0010</strong>:</p><p>The value in binary is <strong>0010</strong> of bit 31, 30, 29 and 28 (<strong>NZCV</strong>) that would mean:</p><p><strong>Negative Flag NOT Set</strong></p><p><strong>Zero Flag NOT SET</strong></p><p><strong>Carry Flag SET</strong></p><p><strong>Overflow Flag NOT Set</strong></p><p>We see that the <strong>Carry Flag</strong> was set and the <strong>Overflow Flag </strong>was NOT set. Why is that?</p><p>The <strong>Carry Flag</strong> is a flag set when two <strong>unsigned numbers</strong> were added and the result is larger than the register where it is saved. We are dealing with a 32-bit register. We are also dealing with unsigned numbers therefore the <strong>CF</strong> is set and the <strong>OF</strong> was not as the <strong>OF</strong> flag deals with <strong>signed numbers</strong>.</p><p>Next week we will dive into Hacking ADDS.</p>