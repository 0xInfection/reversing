<h1>Part 39 - Why C?</h1><p>For a complete table of contents of all the lessons please click below as it will give you a brief of each lesson in addition to the topics it will cover.Â https://github.com/mytechnotalent/Reverse-Engineering-Tutorial</p><p>Ok it is time we look at the most basic C program, debug it and hack it. If we are to have mastery we must create and destroy in a single-step so that we have mastery over the domain.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFhKrIQN4pv5g/article-inline_image-shrink_1000_1488/0/1565910335250?e=1614211200&amp;v=beta&amp;t=XRiM3pS2RD6W2Vj1N4Ho5PjUBZZtycprKjre43FV7Zc"/></div><p>Let us fire up VIM and type out the following. We include our standard library and create a main function to which we use the library function of printf to echo a string of chars and since the type of main is int meaning integer we return 0.</p><p>Let us compile and see what happens when we run:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHtCIH1D9SY4A/article-inline_image-shrink_1000_1488/0/1565910684168?e=1614211200&amp;v=beta&amp;t=v-lX2_270YMzK6-Ht1k5oLN6QbVuBDZmUmUHlbNqBnc"/></div><p>As we see like we did in our C++ example we see '<strong>Hello World!</strong>' echoed successfully.</p><p>Let's debug in Radare:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFMERmwTZesYQ/article-inline_image-shrink_1000_1488/0/1566057508295?e=1614211200&amp;v=beta&amp;t=UTeDin-TI3b6CVARIk7okQd3PTwE4o9UYyn_ZgALqcQ"/></div><p>This is simple, we use <strong>aaa</strong> to analyze the binary and seek to main with <strong>s sym.main</strong>.</p><p>Let's look at the assembly and analyze:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHt0UUOp9rmQw/article-inline_image-shrink_1000_1488/0/1566057552155?e=1614211200&amp;v=beta&amp;t=u1_WOzuEyPDV7L41xZEeDa1lR8G9QGPRwjj9Vav3PEg"/></div><p>Assembly! The definition of raw sexy!</p><p>I went over this in detail in the previous lessons on Assembly but let us review.</p><p>1)We <strong>push rbp </strong>which means we push the value currently in the base pointer onto the stack.</p><p>2)We <strong>lea rdi, qword str.Hello_World </strong>which means we load the effective address of the quad word of our string into the <strong>rdi</strong> register. So far should be simple for you to follow along.</p><p>3)We then <strong>call sym.imp.puts</strong> um wait! We used <strong>printf</strong> what the hell! Well our compiler optimizes our code and the compiler chose the <strong>puts</strong> function in the stdio library to echo the string to our terminal. Again easy enough.</p><p>4)We clean out <strong>eax</strong> and then pop the original value in the <strong>rbp</strong> register back into <strong>rbp</strong>. If you are confused by this review the earlier part of the series please.</p><p>We know our string '<strong>Hello World!</strong>' lives at a pretty house in Arlington, VA at the address of <strong>0x2004</strong> well ok, it's not Arlington, VA but it is in mapped memory (since we are not technically debugging we are messing with mapped code meaning the same values on disk).</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEHzarQ6JQi5A/article-inline_image-shrink_1000_1488/0/1565911732441?e=1614211200&amp;v=beta&amp;t=jo9TpeQVqdJ85N0BeEjzrMLCvndWUw0dwmxLfrdtMn8"/></div><p>To confirm we see the value at <strong>0x2004</strong> is '<strong>Hello World!</strong>' Let's hack that value to anything we want with the <strong>w</strong> command and write directly to that mapped memory address.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFcAq7XdJb2bg/article-inline_image-shrink_1000_1488/0/1565911764019?e=1614211200&amp;v=beta&amp;t=puGLCd2aairEqGdr-1sJI6sQd20rOsWjH5brUiGaSno"/></div><p>Let us re-examine who NOW lives in our Arlington, VA house!</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQF7NAd3tUqMXg/article-inline_image-shrink_1000_1488/0/1565911840111?e=1614211200&amp;v=beta&amp;t=3yOJX1VJJ8P0UWrROZqmYS4d5BLzCo9OUy9F7m11yIQ"/></div><p>Success! We hacked the value and when we exit our debugger we see:</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFN2s98z2OQUg/article-inline_image-shrink_1000_1488/0/1565911868600?e=1614211200&amp;v=beta&amp;t=Gs22xDE7tTsGIQgSfD7dCAp6rlbVfv-_SDEWbD1aOF4"/></div><p>We have successfully altered the binary.</p><p>This is alot to digest here. If you are stumped ask questions in the comments PLEASE! Do not continue as I am here to help. It is CRITICAL you understand these most basic things before we continue!</p>