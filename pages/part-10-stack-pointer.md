<h1>Part 10 - Stack Pointer</h1><p>For a complete table of contents of all the lessons please click below as it will give you a brief of each lesson in addition to the topics it will cover. https://github.com/mytechnotalent/Reverse-Engineering-Tutorial</p><p>The Stack is an abstract data type to which is a LIFO (Last In First Out). When we push a value onto the stack it goes into the Stack Pointer and when it is popped off of the stack it pops the value off of the stack and into a register of your choosing.</p><p>CODE TIME! Again, don’t be discouraged if you don’t understand everything in the code example here. It will become clear over the next few lessons.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHF6NDjdFFkWg/article-inline_image-shrink_1000_1488/0/1520149187367?e=1614211200&amp;v=beta&amp;t=tmkcRd7PKv1Q4GDziax5f5jAXVbaeKRikhsg337Y5DY"/></div><p>To compile:</p><pre spellcheck="false">as -o sp_demo.o sp_demo.s

ld -o sp_demo sp_demo.o
</pre><p>Once again lets load the binary into GDB to see what is happening.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHUcXsY1X1hdQ/article-inline_image-shrink_1000_1488/0/1520209893418?e=1614211200&amp;v=beta&amp;t=ZufIijqOCdAkWBS5AhLTHmPP5Or57oZcs1ae-NNlwOQ"/></div><p>Lets step into one time.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEDXzNHL0qSJw/article-inline_image-shrink_1000_1488/0/1520232603248?e=1614211200&amp;v=beta&amp;t=zZ-Ow2aI61-eT6qZ7S2e1LAXbkM1BoHmKOdJawi92Ik"/></div><p>We see <strong>hex 30</strong> or <strong>48 decimal</strong> moved into <strong>r7</strong>. Lets step into again.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQHAO3eI2pxvRg/article-inline_image-shrink_1000_1488/0/1520238832288?e=1614211200&amp;v=beta&amp;t=PtjUak60uUwP3Xx2lH-mD8Ua9akoQ9lgxxvTxBRL2ZA"/></div><p>We see the value of the <strong>sp</strong> change from <strong>0x7efff3a0</strong> to <strong>0xefff39c</strong>. That is a movement backward <strong>4 bytes</strong>. Why the heck is the stack pointer going backward you may ask!</p><p>The answer revolves around the fact that the stack grows <strong>DOWNWARD</strong>. When we say the top of the stack you can imagine a series of plates being placed <strong>BENEATH</strong> of each other.</p><p>Originally the <strong>sp</strong> was at <strong>0x7efff3a0</strong>.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQGk-AQVLwT47g/article-inline_image-shrink_1000_1488/0/1520218097215?e=1614211200&amp;v=beta&amp;t=cjzwF9bIQJ4y30gLhExwdZl_XjlKYo2UMotEuUIpO4c"/></div><p>When we pushed <strong>r7</strong> onto the stack, the new value of the <strong>Stack Pointer</strong> is now <strong>0x7efff39c</strong> so we can see the Stack truly grows <strong>DOWNWARD</strong> in memory.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQE9USjiBS22Dw/article-inline_image-shrink_1000_1488/0/1520239285552?e=1614211200&amp;v=beta&amp;t=2WxZjLaP11OGwI0r8RlSsmeDj3OE6bsKyF_siIBxYSs"/></div><p>Now lets step into again.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQE-tIYlBxJojQ/article-inline_image-shrink_1000_1488/0/1520143279567?e=1614211200&amp;v=beta&amp;t=UuUIo2c8Cb629giyBGgjQwlYxaQ3zFp_-CE-bm0BxsU"/></div><p>We can see the value of <strong>hex 10</strong> or <strong>decimal 16</strong> moved into <strong>r7</strong>. Notice the <strong>sp</strong> did not change.</p><p>Before we step into again, lets look at the value inside the <strong>sp</strong>.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEVMeFVwK6yUw/article-inline_image-shrink_1000_1488/0/1520216970660?e=1614211200&amp;v=beta&amp;t=GgjQDq2hKPxpnU6TBFcPhDRr5hq8YM67pVvQXYtEzC8"/></div><p>Lets step into again.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFxltd6ZKGHlA/article-inline_image-shrink_1000_1488/0/1520233070958?e=1614211200&amp;v=beta&amp;t=6_tUIfQUeauhHObA0oAvnCxf0H_JH94A00P9GMaTBuo"/></div><p>We see the value in the stack was popped off the stack and put back into <strong>r7</strong> therefore the value of <strong>hex 30</strong> is back in <strong>r7</strong> as well as the <strong>sp</strong> is back at <strong>0x73fff3a0</strong>.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQGFQkyMfVuY6A/article-inline_image-shrink_1000_1488/0/1520232081853?e=1614211200&amp;v=beta&amp;t=yeKZSWGTmOM_eE6GBJdnLagJ5x7piX8ndtk_DcIC7Js"/></div><p>Please take the time to type out the code, compile and link it and then step through the binary in GDB. Stack operations are critical to understanding Reverse Engineering and Malware Analysis as well as any debugging of any kind.</p><p>Next week we will dive into ARM Firmware Boot Procedures.</p>