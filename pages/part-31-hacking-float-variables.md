<h1>Part 31 – Hacking Float Variables</h1><p>For a complete table of contents of all the lessons please click below as it will give you a brief of each lesson in addition to the topics it will cover. https://github.com/mytechnotalent/Reverse-Engineering-Tutorial</p><p>Let’s re-examine our code.</p><pre spellcheck="false">#include &lt;iostream&gt;

 

int main(void) {

            int myNumber = 1337.1;

 

            std::cout &lt;&lt; myNumber &lt;&lt; std::endl;

 

            return 0;

}
</pre><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEZRad58-KHSw/article-inline_image-shrink_1000_1488/0/1521799049547?e=1614211200&amp;v=beta&amp;t=87pvQJDDfSo_RScfiDFHdEtVk3_eMoiY3fnJk6kcEYQ"/></div><p>Let’s review last week’s tutorial.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQES3QRrE1zTFQ/article-inline_image-shrink_1000_1488/0/1521799097861?e=1614211200&amp;v=beta&amp;t=x96xvQAgyek-64icyPN5GBBwJV1JsYCcLoO4ImstJFU"/></div><p>Let’s break on <strong>main+20</strong> and continue to that point.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEa1tu_UEQ2Hg/article-inline_image-shrink_1000_1488/0/1521799125882?e=1614211200&amp;v=beta&amp;t=syEPLG5WYSLlyt0vSSC5knbrVBULQXiWqna8aHamLKI"/></div><p>Let’s examine what value is inside <strong>r11-8</strong>. We clearly see it is <strong>1337.09998</strong> which approximates our value in our original c++ code. Keep in mind a float has roughly 7 decimal digits of precision and that is why we do not see <strong>1337.1</strong> so please remember that as we go forward.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEg5_6DOSJBuA/article-inline_image-shrink_1000_1488/0/1521799166328?e=1614211200&amp;v=beta&amp;t=SmxUOg6Gvqjd-NGcq0TtxRkIYcOZAmYv2V49JQ0CmVQ"/></div><p>We can also see this value in high memory.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQF3sRIMVARPXQ/article-inline_image-shrink_1000_1488/0/1521799204709?e=1614211200&amp;v=beta&amp;t=zyo6X677S8OdIXRd72GP_QfpOdCVBqI_hY5VGiZUFCg"/></div><p>Let’s break on <strong>main+28</strong> and continue.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEWhvmXMw5DAw/article-inline_image-shrink_1000_1488/0/1521799242840?e=1614211200&amp;v=beta&amp;t=CJD_jAhFByXmtiWq7lH3io1HOL8k-9NKtf7mguCjtVM"/></div><p>We see a strange new instruction. We see <strong>vldr</strong> and the value within <strong>r11, #8</strong> being moved into<strong> s0</strong>. So what is <strong>s0</strong>? We have a math co-processor which has a series of additional registers that work with decimal or floating-point numbers. Here we see an example of such to which the value of <strong>1337.09998 </strong>is being moved into <strong>s0</strong>. The <strong>vldr</strong> instruction loads a constant value into every element of a single-precision or double-precision register such as<strong> s0</strong>.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQFsNZMexdd8yg/article-inline_image-shrink_1000_1488/0/1521799279756?e=1614211200&amp;v=beta&amp;t=RVWgvwyLICipNXQTCjgCQDXxD4BpveCvlF31ZXbyJNk"/></div><p>We can only see these special registers if we do a info registers all command as we do below.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQGe7H7kTXHOTg/article-inline_image-shrink_1000_1488/0/1521799307421?e=1614211200&amp;v=beta&amp;t=Yew3wybf-AOjX3_r8wV-PECqioPdQTSdrS8K_AbbV8s"/></div><p>Below we see the value now being moved into <strong>s0</strong>.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQGxpvOHpzuhWQ/article-inline_image-shrink_1000_1488/0/1521799331767?e=1614211200&amp;v=beta&amp;t=C63jbySwMwNn1t_bElv2MYP1fLlOlLl4OWWy29vMqAI"/></div><p>Let’s hack!</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQF5koEdhSnLvg/article-inline_image-shrink_1000_1488/0/1521799362535?e=1614211200&amp;v=beta&amp;t=fsreQ6HTH-jy2IiyBi9a6CsCsawzSv9kysTpJTxLJeg"/></div><p>Let’s now look at the registers and see what has transpired.</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQEPBsCYZygZpA/article-inline_image-shrink_1000_1488/0/1521799386349?e=1614211200&amp;v=beta&amp;t=QXhSEItu85cn3zzcFZMlwvgoo7a8Zs_PgZBnxyR4-7o"/></div><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQF3fuShD-SosQ/article-inline_image-shrink_1000_1488/0/1521799407513?e=1614211200&amp;v=beta&amp;t=Ulx1HQbN7_6780oKJwAyKChjAoxQGD853RN2IbbpB98"/></div><p>As you can see we have hacked the value (less the precision issue of the float variable accurate up to 6 decimal places)!</p><div class="slate-resizable-image-embed slate-image-embed__resize-full-width"><img src="https://media-exp1.licdn.com/dms/image/C4E12AQGDSlHn23_aEQ/article-inline_image-shrink_1000_1488/0/1521799441419?e=1614211200&amp;v=beta&amp;t=wkUxDMKbDvQfnDSLVZzDfrFQ6G5MzDYs6Pd1Vx7D-Ww"/></div><p>Finally as we continue we see our hacked value echoed back out to the terminal when the c++ <strong>cout </strong>function executes.</p><p>Next week we will dive into Double Variables.</p>